{% extends "users/basic.html" %}

{% block content %}
<div class="container py-5">
    <h1 class="text-center mb-4">Movies</h1>

    <!-- FILTER FORM -->
    <form method="GET" action="{% url 'movie_list' %}" class="mb-5">
        <div class="row g-2 align-items-end">

            <!-- Search -->
            <div class="col-md-4">
                <input
                    type="text"
                    name="search"
                    class="form-control form-control-lg"
                    placeholder="Search movies"
                    value="{{ search_value|default_if_none:'' }}"
                />
            </div>

            <!-- Genre -->
            <div class="col-md-3">
                <select name="genre" class="form-control form-control-lg">
                    <option value="">All Genres</option>
                    {% for g in genres %}
                        <option value="{{ g }}" {% if g == selected_genre %}selected{% endif %}>
                            {{ g }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <!-- Language -->
            <div class="col-md-3">
                <select name="language" class="form-control form-control-lg">
                    <option value="">All Languages</option>
                    {% for lang in languages %}
                        <option value="{{ lang }}" {% if lang == selected_language %}selected{% endif %}>
                            {{ lang }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <!-- Button -->
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary btn-lg w-100">
                    Filter
                </button>
            </div>
        </div>
    </form>

    <!-- MOVIE LIST -->
    <div class="row">
        {% for movie in movies %}
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
                {% if movie.image %}
                <img src="{{ movie.image.url }}" class="card-img-top" style="height:300px;object-fit:cover;">
                {% endif %}
                <div class="card-body">
                    <h5 class="card-title">{{ movie.name }}</h5>
                    <p>
                        <i class="fas fa-star text-warning"></i> {{ movie.rating }}
                    </p>
                    <p class="text-muted">
                        <strong>Genre:</strong> {{ movie.genre }} <br>
                        <strong>Language:</strong> {{ movie.language }}
                    </p>
                    <p class="small">Cast: {{ movie.cast }}</p>
                </div>
                <div class="card-footer bg-white">
                    <a href="{% url 'movie_detail' movie.id %}" class="btn btn-outline-primary w-100">
                        View Details
                    </a>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12 text-center">
            <p class="lead">No movies found.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
